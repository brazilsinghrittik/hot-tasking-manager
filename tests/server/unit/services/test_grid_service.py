import unittest
from server.services.grid_service import GridService
from server.models.dtos.grid_dto import GridDTO
from tests.server.helpers.test_helpers import get_canned_grid_request
import geojson
import json

class TestGridService(unittest.TestCase):
    skip_tests = False

    def test_feature_collection_to_multiPolygon(self):
        # arrange
        grid_json = get_canned_grid_request()
        grid_dto = GridDTO(grid_json)
        expected = 'MULTIPOLYGON (((3097992.756398193 1033122.874302443, 3097992.756398193 1032970.000245875, 3097839.882341623 1032970.000245868, 3097839.882341623 1033122.874302443, 3097992.756398193 1033122.874302443)), ((3097687.008285054 1033734.370528723, 3097687.008285054 1033581.496472148, 3097534.134228482 1033581.496472153, 3097534.134228481 1033734.370528723, 3097687.008285054 1033734.370528723)), ((3105177.837057 1033581.496472157, 3105177.837057 1033734.370528728, 3105330.71111357 1033887.24458529, 3105483.58517014 1033887.244585291, 3105483.58517014 1033734.370528729, 3105483.58517014 1033581.496472154, 3105330.71111357 1033581.496472153, 3105177.837057 1033581.496472157)), ((3100132.993190178 1034192.992698434, 3100132.993190178 1034040.118641863, 3099980.119133608 1034040.118641869, 3099980.119133608 1034192.992698431, 3100132.993190178 1034192.992698434)), ((3085457.083759424 1035263.111094425, 3085457.083759424 1035415.985150996, 3085609.957815995 1035415.985150996, 3085609.957815994 1035263.111094428, 3085457.083759424 1035263.111094425)), ((3091113.423852528 1035263.111094428, 3091113.423852528 1035415.985150992, 3091266.297909098 1035568.859207569, 3091419.171965668 1035568.859207567, 3091419.171965668 1035415.985150996, 3091266.297909098 1035263.11109442, 3091113.423852528 1035263.111094428)), ((3068640.937536685 1035415.985150996, 3068640.937536685 1035568.859207564, 3068793.811593256 1035568.859207564, 3068793.811593256 1035415.985151002, 3068640.937536685 1035415.985150996)), ((3058245.501689902 1036638.977603558, 3058092.627633332 1036638.977603557, 3058092.627633332 1036791.851660132, 3058245.501689902 1036791.851660132, 3058245.501689902 1036638.977603558)), ((3056258.138954487 1036638.977603563, 3056258.138954487 1036791.851660126, 3056411.013011057 1036791.851660132, 3056411.013011058 1036638.977603563, 3056258.138954487 1036638.977603563)), ((3079189.247440042 1036027.481377278, 3079189.24744004 1035874.607320712, 3079036.37338347 1035874.607320709, 3079036.37338347 1036027.481377278, 3079189.247440042 1036027.481377278)), ((3084081.21725029 1036180.355433844, 3084081.217250292 1036027.481377278, 3083928.343193721 1036027.481377278, 3083775.469137151 1036027.481377278, 3083775.469137151 1036180.355433854, 3083928.343193721 1036180.355433849, 3084081.21725029 1036180.355433844)), ((3068946.685649826 1036027.481377273, 3068946.685649827 1036180.355433851, 3068946.685649827 1036333.229490418, 3069099.559706397 1036333.229490413, 3069099.559706397 1036180.355433844, 3069099.559706397 1036027.481377279, 3068946.685649826 1036027.481377273)), ((3082093.854514876 1038320.592225835, 3082093.854514877 1038167.718169259, 3081940.980458307 1038167.718169259, 3081940.980458307 1038320.592225829, 3082093.854514876 1038320.592225835)), ((3056869.635180769 1038779.21439554, 3056869.635180769 1038932.08845212, 3057022.50923734 1038932.088452115, 3057022.509237338 1038779.21439554, 3056869.635180769 1038779.21439554)), ((3074450.15168636 1039237.836565251, 3074297.277629788 1039237.836565259, 3074297.277629788 1039390.710621827, 3074450.15168636 1039390.710621828, 3074450.15168636 1039237.836565251)), ((3093406.534701082 1040002.206848104, 3093406.534701082 1039849.332791534, 3093253.660644513 1039849.332791533, 3093253.660644513 1040002.206848105, 3093406.534701082 1040002.206848104)), ((3095088.149323357 1039849.332791539, 3095088.149323357 1040002.206848104, 3095241.023379927 1040002.20684811, 3095393.897436496 1040002.206848106, 3095393.897436496 1039849.332791538, 3095241.023379928 1039849.332791538, 3095088.149323357 1039849.332791539)), ((3078119.129044048 1040307.954961242, 3077966.254987478 1040307.954961248, 3077966.254987478 1040460.829017824, 3078119.129044048 1040460.829017822, 3078119.129044048 1040307.954961242)), ((3094629.527153646 1040002.206848114, 3094476.653097075 1040002.206848109, 3094476.653097075 1040155.080904674, 3094629.527153646 1040155.080904678, 3094629.527153646 1040002.206848114)), ((3066347.826688131 1041072.325244096, 3066194.95263156 1041072.325244094, 3066194.952631561 1041225.199300668, 3066347.826688131 1041225.199300669, 3066347.826688131 1041072.325244096)), ((3094782.401210216 1041378.073357238, 3094782.401210216 1041225.199300665, 3094629.527153646 1041225.199300665, 3094629.527153646 1041378.073357246, 3094782.401210216 1041378.073357238)), ((3084081.217250292 1036791.851660128, 3084081.217250292 1036944.725716695, 3084234.091306862 1036944.725716702, 3084234.091306861 1036791.851660126, 3084081.217250292 1036791.851660128)), ((3075978.892252062 1036944.7257167, 3075826.018195493 1036944.725716705, 3075826.018195493 1037097.599773272, 3075978.892252063 1037097.599773273, 3075978.892252062 1036944.7257167)), ((3049225.932352251 1042142.443640089, 3049073.05829568 1042142.443640095, 3049073.058295681 1042295.317696666, 3049225.932352251 1042295.317696662, 3049225.932352251 1042142.443640089)), ((3090960.549795958 1042601.065809806, 3090807.675739387 1042601.065809804, 3090807.675739386 1042753.939866378, 3090807.675739387 1042906.813922941, 3090960.549795958 1042906.813922946, 3090960.549795957 1042753.939866376, 3090960.549795958 1042601.065809806)), ((3051366.169144236 1043671.184205794, 3051366.169144236 1043824.058262367, 3051519.043200806 1043824.058262367, 3051519.043200806 1043671.184205798, 3051366.169144236 1043671.184205794)), ((3077049.010648055 1042601.065809801, 3076896.136591486 1042601.065809804, 3076896.136591486 1042753.939866378, 3077049.010648055 1042753.939866376, 3077201.884704626 1042753.939866369, 3077201.884704625 1042601.065809806, 3077049.010648055 1042601.065809801)), ((3082552.476684588 1042295.317696662, 3082399.602628018 1042295.317696666, 3082399.602628017 1042448.191753237, 3082552.476684588 1042601.0658098, 3082705.350741159 1042601.065809808, 3082705.350741159 1042448.19175323, 3082552.476684588 1042295.317696662)), ((3087138.698381699 1043976.932318933, 3086985.824325128 1043976.932318939, 3086985.824325128 1044129.806375507, 3086985.824325128 1044282.680432072, 3087138.698381697 1044282.680432071, 3087291.572438268 1044282.680432079, 3087291.572438269 1044129.806375503, 3087291.572438268 1043976.93231894, 3087138.698381699 1043976.932318933)), ((3063748.967726434 1044588.428545222, 3063748.967726435 1044741.302601788, 3063748.967726434 1044894.176658356, 3063748.967726435 1045047.050714931, 3063901.841783005 1045047.050714925, 3063901.841783005 1044894.176658361, 3063901.841783005 1044741.302601791, 3063901.841783005 1044588.428545214, 3063748.967726434 1044588.428545222)), ((3082552.476684588 1044894.176658363, 3082399.602628018 1044894.176658356, 3082399.602628017 1045047.050714931, 3082552.476684588 1045047.050714934, 3082552.476684588 1044894.176658363)), ((3075061.647912642 1043671.184205799, 3074908.77385607 1043671.184205798, 3074908.77385607 1043824.058262367, 3075061.647912642 1043824.058262361, 3075214.52196921 1043824.058262367, 3075367.396025781 1043824.058262367, 3075367.396025781 1043671.184205796, 3075214.52196921 1043671.184205794, 3075061.647912642 1043671.184205799)), ((3084234.09130198 1043772.519695203, 3084234.091306861 1043671.184205799, 3084081.217250292 1043671.184205798, 3084081.217245433 1043772.827025576, 3084081.217250292 1043824.058262366, 3084081.217250292 1044129.806375503, 3084081.217250292 1044282.680432072, 3084234.091306862 1044282.680432079, 3084234.091306862 1044129.806375503, 3084234.091306862 1043824.058262361, 3084234.09130198 1043772.519695203)), ((3068640.937536686 1045964.295054347, 3068640.937536686 1046117.169110918, 3068793.811593256 1046117.169110922, 3068793.811593256 1045964.295054352, 3068640.937536686 1045964.295054347)), ((3064054.715839576 1046728.6653372, 3064054.715839576 1046575.791280635, 3063901.841783005 1046575.791280634, 3063901.841783004 1046728.665337203, 3064054.715839576 1046728.6653372)), ((3047850.065843117 1047340.161563487, 3047697.191786548 1047340.161563484, 3047697.191786548 1047493.035620054, 3047850.065843117 1047493.035620055, 3047850.065843117 1047340.161563487)), ((3058398.375746472 1047951.657789764, 3058398.375746472 1047798.783733198, 3058245.501689902 1047798.7837332, 3058245.501689902 1047951.657789767, 3058398.375746472 1047951.657789764)), ((3077049.010648055 1047951.657789766, 3076896.136591486 1047951.657789766, 3076896.136591486 1048104.531846338, 3077049.010648055 1048104.531846333, 3077049.010648055 1047951.657789766)), ((3065430.582348707 1049021.776185761, 3065430.582348707 1048868.902129187, 3065277.708292139 1048868.902129191, 3065277.708292138 1049021.776185757, 3065430.582348707 1049021.776185761)), ((3058551.249803043 1048868.902129192, 3058551.249803043 1049021.776185755, 3058704.123859613 1049021.776185762, 3058704.123859611 1048868.902129187, 3058551.249803043 1048868.902129192)), ((3063443.219613295 1049633.272412044, 3063443.219613294 1049480.398355468, 3063290.345556723 1049480.398355469, 3063290.345556723 1049633.272412043, 3063443.219613295 1049633.272412044)), ((3073074.285177226 1046728.665337202, 3072921.411120655 1046728.665337205, 3072921.411120655 1046881.53939377, 3073074.285177226 1046881.53939377, 3073074.285177226 1046728.665337202)), ((3064819.086122428 1047034.413450347, 3064819.086122428 1046881.539393774, 3064666.212065857 1046881.539393777, 3064666.212065857 1047034.413450341, 3064819.086122428 1047034.413450347)), ((3071392.670554953 1046881.53939377, 3071239.796498382 1046881.539393774, 3071239.796498382 1047034.413450347, 3071545.544611523 1047187.287506909, 3071698.418668093 1047187.287506909, 3071698.418668093 1047034.413450341, 3071392.670554953 1046881.53939377)), ((3074755.8997995 1041683.821470383, 3074755.8997995 1041836.695526954, 3074755.8997995 1041989.569583527, 3074908.77385607 1041989.569583519, 3075061.647912642 1041989.569583527, 3075061.647912642 1041836.695526945, 3075061.64791264 1041683.821470377, 3074908.77385607 1041683.821470385, 3074755.8997995 1041683.821470383)), ((3081788.106401737 1041836.695526954, 3081635.232345166 1041836.695526956, 3081635.232345166 1041989.56958352, 3081788.106401735 1041989.56958352, 3081940.980458305 1041989.569583517, 3082093.854514876 1041989.569583525, 3082093.854514876 1041836.695526945, 3081940.980458307 1041836.695526956, 3081788.106401737 1041836.695526954)), ((3067417.945084123 1041989.569583517, 3067417.945084123 1042142.443640089, 3067570.819140693 1042142.44364009, 3067570.819140693 1041989.56958352, 3067417.945084123 1041989.569583517)), ((3092489.290361661 1041989.56958352, 3092336.41630509 1041989.56958352, 3092336.41630509 1042142.443640088, 3092489.290361661 1042142.443640088, 3092642.164418231 1042142.443640094, 3092795.0384748 1042142.443640094, 3092795.038474801 1041989.56958352, 3092642.164418231 1041989.569583517, 3092489.290361661 1041989.56958352)), ((3058704.123859613 1041989.569583517, 3058551.249803043 1041989.56958352, 3058551.249803043 1042142.443640095, 3058704.123859613 1042142.44364009, 3058704.123859613 1041989.569583517)), ((3079189.24744004 1041989.569583523, 3079189.24744004 1042142.443640094, 3079342.12149661 1042142.443640095, 3079342.12149661 1041989.56958352, 3079189.24744004 1041989.569583523)))'

        # act
        result = GridService.feature_collection_to_multiPolygon(grid_dto.area_of_interest, True).wkt

        # assert
        self.assertEquals(expected, result)

    def test_feature_collection_to_multiPolygon(self):
        # arrange
        grid_json = get_canned_grid_request()
        grid_dto = GridDTO(grid_json)
        expected = 'MULTIPOLYGON (((3105177.837057 1033581.496472157, 3105177.837057 1033734.370528728, 3105330.71111357 1033887.24458529, 3105483.58517014 1033887.244585291, 3105483.58517014 1033734.370528729, 3105483.58517014 1033581.496472154, 3105330.71111357 1033581.496472153, 3105177.837057 1033581.496472157)), ((3097687.008285054 1033734.370528723, 3097687.008285054 1033581.496472148, 3097534.134228482 1033581.496472153, 3097534.134228481 1033734.370528723, 3097687.008285054 1033734.370528723)), ((3097992.756398193 1033122.874302443, 3097992.756398193 1032970.000245875, 3097839.882341623 1032970.000245868, 3097839.882341623 1033122.874302443, 3097992.756398193 1033122.874302443)), ((3068640.937536685 1035415.985150996, 3068640.937536685 1035568.859207564, 3068793.811593256 1035568.859207564, 3068793.811593256 1035415.985151002, 3068640.937536685 1035415.985150996)), ((3091113.423852528 1035263.111094428, 3091113.423852528 1035415.985150992, 3091266.297909098 1035568.859207569, 3091419.171965668 1035568.859207567, 3091419.171965668 1035415.985150996, 3091266.297909098 1035263.11109442, 3091113.423852528 1035263.111094428)), ((3085457.083759424 1035263.111094425, 3085457.083759424 1035415.985150996, 3085609.957815995 1035415.985150996, 3085609.957815994 1035263.111094428, 3085457.083759424 1035263.111094425)), ((3100132.993190178 1034192.992698434, 3100132.993190178 1034040.118641863, 3099980.119133608 1034040.118641869, 3099980.119133608 1034192.992698431, 3100132.993190178 1034192.992698434)), ((3084081.21725029 1036180.355433844, 3084081.217250292 1036027.481377278, 3083928.343193721 1036027.481377278, 3083775.469137151 1036027.481377278, 3083775.469137151 1036180.355433854, 3083928.343193721 1036180.355433849, 3084081.21725029 1036180.355433844)), ((3084081.217250292 1036791.851660128, 3084081.217250292 1036944.725716695, 3084234.091306862 1036944.725716702, 3084234.091306861 1036791.851660126, 3084081.217250292 1036791.851660128)), ((3056258.138954487 1036638.977603563, 3056258.138954487 1036791.851660126, 3056411.013011057 1036791.851660132, 3056411.013011058 1036638.977603563, 3056258.138954487 1036638.977603563)), ((3058245.501689902 1036638.977603558, 3058092.627633332 1036638.977603557, 3058092.627633332 1036791.851660132, 3058245.501689902 1036791.851660132, 3058245.501689902 1036638.977603558)), ((3075978.892252062 1036944.7257167, 3075826.018195493 1036944.725716705, 3075826.018195493 1037097.599773272, 3075978.892252063 1037097.599773273, 3075978.892252062 1036944.7257167)), ((3082093.854514876 1038320.592225835, 3082093.854514877 1038167.718169259, 3081940.980458307 1038167.718169259, 3081940.980458307 1038320.592225829, 3082093.854514876 1038320.592225835)), ((3056869.635180769 1038779.21439554, 3056869.635180769 1038932.08845212, 3057022.50923734 1038932.088452115, 3057022.509237338 1038779.21439554, 3056869.635180769 1038779.21439554)), ((3078119.129044048 1040307.954961242, 3077966.254987478 1040307.954961248, 3077966.254987478 1040460.829017824, 3078119.129044048 1040460.829017822, 3078119.129044048 1040307.954961242)), ((3095088.149323357 1039849.332791539, 3095088.149323357 1040002.206848104, 3095241.023379927 1040002.20684811, 3095393.897436496 1040002.206848106, 3095393.897436496 1039849.332791538, 3095241.023379928 1039849.332791538, 3095088.149323357 1039849.332791539)), ((3093406.534701082 1040002.206848104, 3093406.534701082 1039849.332791534, 3093253.660644513 1039849.332791533, 3093253.660644513 1040002.206848105, 3093406.534701082 1040002.206848104)), ((3094629.527153646 1040002.206848114, 3094476.653097075 1040002.206848109, 3094476.653097075 1040155.080904674, 3094629.527153646 1040155.080904678, 3094629.527153646 1040002.206848114)), ((3094782.401210216 1041378.073357238, 3094782.401210216 1041225.199300665, 3094629.527153646 1041225.199300665, 3094629.527153646 1041378.073357246, 3094782.401210216 1041378.073357238)), ((3092489.290361661 1041989.56958352, 3092336.41630509 1041989.56958352, 3092336.41630509 1042142.443640088, 3092489.290361661 1042142.443640088, 3092642.164418231 1042142.443640094, 3092795.0384748 1042142.443640094, 3092795.038474801 1041989.56958352, 3092642.164418231 1041989.569583517, 3092489.290361661 1041989.56958352)), ((3049225.932352251 1042142.443640089, 3049073.05829568 1042142.443640095, 3049073.058295681 1042295.317696666, 3049225.932352251 1042295.317696662, 3049225.932352251 1042142.443640089)), ((3090960.549795958 1042601.065809806, 3090807.675739387 1042601.065809804, 3090807.675739386 1042753.939866378, 3090807.675739387 1042906.813922941, 3090960.549795958 1042906.813922946, 3090960.549795957 1042753.939866376, 3090960.549795958 1042601.065809806)), ((3082552.476684588 1042295.317696662, 3082399.602628018 1042295.317696666, 3082399.602628017 1042448.191753237, 3082552.476684588 1042601.0658098, 3082705.350741159 1042601.065809808, 3082705.350741159 1042448.19175323, 3082552.476684588 1042295.317696662)), ((3077049.010648055 1042601.065809801, 3076896.136591486 1042601.065809804, 3076896.136591486 1042753.939866378, 3077049.010648055 1042753.939866376, 3077201.884704626 1042753.939866369, 3077201.884704625 1042601.065809806, 3077049.010648055 1042601.065809801)), ((3058704.123859613 1041989.569583517, 3058551.249803043 1041989.56958352, 3058551.249803043 1042142.443640095, 3058704.123859613 1042142.44364009, 3058704.123859613 1041989.569583517)), ((3067417.945084123 1041989.569583517, 3067417.945084123 1042142.443640089, 3067570.819140693 1042142.44364009, 3067570.819140693 1041989.56958352, 3067417.945084123 1041989.569583517)), ((3079189.24744004 1041989.569583523, 3079189.24744004 1042142.443640094, 3079342.12149661 1042142.443640095, 3079342.12149661 1041989.56958352, 3079189.24744004 1041989.569583523)), ((3074755.8997995 1041683.821470383, 3074755.8997995 1041836.695526954, 3074755.8997995 1041989.569583527, 3074908.77385607 1041989.569583519, 3075061.647912642 1041989.569583527, 3075061.647912642 1041836.695526945, 3075061.64791264 1041683.821470377, 3074908.77385607 1041683.821470385, 3074755.8997995 1041683.821470383)), ((3081788.106401737 1041836.695526954, 3081635.232345166 1041836.695526956, 3081635.232345166 1041989.56958352, 3081788.106401735 1041989.56958352, 3081940.980458305 1041989.569583517, 3082093.854514876 1041989.569583525, 3082093.854514876 1041836.695526945, 3081940.980458307 1041836.695526956, 3081788.106401737 1041836.695526954)), ((3066347.826688131 1041072.325244096, 3066194.95263156 1041072.325244094, 3066194.952631561 1041225.199300668, 3066347.826688131 1041225.199300669, 3066347.826688131 1041072.325244096)), ((3074450.15168636 1039237.836565251, 3074297.277629788 1039237.836565259, 3074297.277629788 1039390.710621827, 3074450.15168636 1039390.710621828, 3074450.15168636 1039237.836565251)), ((3079189.247440042 1036027.481377278, 3079189.24744004 1035874.607320712, 3079036.37338347 1035874.607320709, 3079036.37338347 1036027.481377278, 3079189.247440042 1036027.481377278)), ((3068946.685649826 1036027.481377273, 3068946.685649827 1036180.355433851, 3068946.685649827 1036333.229490418, 3069099.559706397 1036333.229490413, 3069099.559706397 1036180.355433844, 3069099.559706397 1036027.481377279, 3068946.685649826 1036027.481377273)), ((3087138.698381699 1043976.932318933, 3086985.824325128 1043976.932318939, 3086985.824325128 1044129.806375507, 3086985.824325128 1044282.680432072, 3087138.698381697 1044282.680432071, 3087291.572438268 1044282.680432079, 3087291.572438269 1044129.806375503, 3087291.572438268 1043976.93231894, 3087138.698381699 1043976.932318933)), ((3051366.169144236 1043671.184205794, 3051366.169144236 1043824.058262367, 3051519.043200806 1043824.058262367, 3051519.043200806 1043671.184205798, 3051366.169144236 1043671.184205794)), ((3075061.647912642 1043671.184205799, 3074908.77385607 1043671.184205798, 3074908.77385607 1043824.058262367, 3075061.647912642 1043824.058262361, 3075214.52196921 1043824.058262367, 3075367.396025781 1043824.058262367, 3075367.396025781 1043671.184205796, 3075214.52196921 1043671.184205794, 3075061.647912642 1043671.184205799)), ((3084234.09130198 1043772.519695203, 3084234.091306861 1043671.184205799, 3084081.217250292 1043671.184205798, 3084081.217245433 1043772.827025576, 3084081.217250292 1043824.058262366, 3084081.217250292 1044129.806375503, 3084081.217250292 1044282.680432072, 3084234.091306862 1044282.680432079, 3084234.091306862 1044129.806375503, 3084234.091306862 1043824.058262361, 3084234.09130198 1043772.519695203)), ((3082552.476684588 1044894.176658363, 3082399.602628018 1044894.176658356, 3082399.602628017 1045047.050714931, 3082552.476684588 1045047.050714934, 3082552.476684588 1044894.176658363)), ((3063748.967726434 1044588.428545222, 3063748.967726435 1044741.302601788, 3063748.967726434 1044894.176658356, 3063748.967726435 1045047.050714931, 3063901.841783005 1045047.050714925, 3063901.841783005 1044894.176658361, 3063901.841783005 1044741.302601791, 3063901.841783005 1044588.428545214, 3063748.967726434 1044588.428545222)), ((3068640.937536686 1045964.295054347, 3068640.937536686 1046117.169110918, 3068793.811593256 1046117.169110922, 3068793.811593256 1045964.295054352, 3068640.937536686 1045964.295054347)), ((3064054.715839576 1046728.6653372, 3064054.715839576 1046575.791280635, 3063901.841783005 1046575.791280634, 3063901.841783004 1046728.665337203, 3064054.715839576 1046728.6653372)), ((3047850.065843117 1047340.161563487, 3047697.191786548 1047340.161563484, 3047697.191786548 1047493.035620054, 3047850.065843117 1047493.035620055, 3047850.065843117 1047340.161563487)), ((3058398.375746472 1047951.657789764, 3058398.375746472 1047798.783733198, 3058245.501689902 1047798.7837332, 3058245.501689902 1047951.657789767, 3058398.375746472 1047951.657789764)), ((3077049.010648055 1047951.657789766, 3076896.136591486 1047951.657789766, 3076896.136591486 1048104.531846338, 3077049.010648055 1048104.531846333, 3077049.010648055 1047951.657789766)), ((3073074.285177226 1046728.665337202, 3072921.411120655 1046728.665337205, 3072921.411120655 1046881.53939377, 3073074.285177226 1046881.53939377, 3073074.285177226 1046728.665337202)), ((3064819.086122428 1047034.413450347, 3064819.086122428 1046881.539393774, 3064666.212065857 1046881.539393777, 3064666.212065857 1047034.413450341, 3064819.086122428 1047034.413450347)), ((3071392.670554953 1046881.53939377, 3071239.796498382 1046881.539393774, 3071239.796498382 1047034.413450347, 3071545.544611523 1047187.287506909, 3071698.418668093 1047187.287506909, 3071698.418668093 1047034.413450341, 3071392.670554953 1046881.53939377)), ((3065430.582348707 1049021.776185761, 3065430.582348707 1048868.902129187, 3065277.708292139 1048868.902129191, 3065277.708292138 1049021.776185757, 3065430.582348707 1049021.776185761)), ((3058551.249803043 1048868.902129192, 3058551.249803043 1049021.776185755, 3058704.123859613 1049021.776185762, 3058704.123859611 1048868.902129187, 3058551.249803043 1048868.902129192)), ((3063443.219613295 1049633.272412044, 3063443.219613294 1049480.398355468, 3063290.345556723 1049480.398355469, 3063290.345556723 1049633.272412043, 3063443.219613295 1049633.272412044)))'

        # act
        result = GridService.feature_collection_to_multiPolygon(grid_dto.area_of_interest, False).wkt

        # assert
        self.assertEquals(expected, result)

    def test_trim_grid_to_aoi_clip(self):
        # arrange
        grid_json = get_canned_grid_request()

        grid_dto = GridDTO(grid_json)
        expected = geojson.FeatureCollection([{"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3047850.065843117, 1047340.161563487], [3047697.191786548, 1047340.161563484], [3047697.191786548, 1047493.035620054], [3047850.065843117, 1047493.035620055], [3047850.065843117, 1047340.161563487]]]]}, "properties": {"splittable": False, "x": 18876, "y": 17240, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3049225.932352251, 1042142.443640089], [3049073.05829568, 1042142.443640095], [3049073.058295681, 1042295.317696666], [3049225.932352251, 1042295.317696662], [3049225.932352251, 1042142.443640089]]]]}, "properties": {"splittable": False, "x": 18877, "y": 17236, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3051366.169144236, 1043671.184205794], [3051366.169144236, 1043824.058262367], [3051519.043200806, 1043824.058262367], [3051519.043200806, 1043671.184205798], [3051366.169144236, 1043671.184205794]]]]}, "properties": {"splittable": False, "x": 18879, "y": 17237, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3056258.138954487, 1036638.977603563], [3056258.138954487, 1036791.851660126], [3056411.013011057, 1036791.851660132], [3056411.013011058, 1036638.977603563], [3056258.138954487, 1036638.977603563]]]]}, "properties": {"splittable": False, "x": 18883, "y": 17231, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3056869.635180769, 1038779.21439554], [3056869.635180769, 1038932.08845212], [3057022.50923734, 1038932.088452115], [3057022.509237338, 1038779.21439554], [3056869.635180769, 1038779.21439554]]]]}, "properties": {"splittable": False, "x": 18883, "y": 17233, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3058245.501689902, 1036638.977603558], [3058092.627633332, 1036638.977603557], [3058092.627633332, 1036791.851660132], [3058245.501689902, 1036791.851660132], [3058245.501689902, 1036638.977603558]]]]}, "properties": {"splittable": False, "x": 18884, "y": 17231, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3058704.123311721, 1041989.569583517], [3058551.249803043, 1041989.56958352], [3058551.249803043, 1042142.443640095], [3058704.123311721, 1042142.44364009], [3058704.123311721, 1041989.569583517]]]]}, "properties": {"splittable": False, "x": 18884, "y": 17236, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3058398.375746472, 1047951.657789764], [3058398.375746472, 1047798.783733198], [3058245.501689902, 1047798.7837332], [3058245.501689902, 1047951.657789767], [3058398.375746472, 1047951.657789764]]]]}, "properties": {"splittable": False, "x": 18884, "y": 17240, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3058551.249803043, 1048868.902129192], [3058551.249803043, 1049021.776185755], [3058704.123311721, 1049021.776185762], [3058704.123311721, 1048868.902129187], [3058551.249803043, 1048868.902129192]]]]}, "properties": {"splittable": False, "x": 18884, "y": 17241, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3058704.123859613, 1041989.569583517], [3058704.123311721, 1041989.569583517], [3058704.123311721, 1042142.44364009], [3058704.123859613, 1042142.44364009], [3058704.123859613, 1041989.569583517]]]]}, "properties": {"splittable": False, "x": 18885, "y": 17236, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3058704.123311721, 1049021.776185762], [3058704.123859613, 1049021.776185762], [3058704.123859611, 1048868.902129187], [3058704.123311721, 1048868.902129187], [3058704.123311721, 1049021.776185762]]]]}, "properties": {"splittable": False, "x": 18885, "y": 17241, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3063443.219613295, 1049633.272412044], [3063443.219613294, 1049480.398355468], [3063290.345556723, 1049480.398355469], [3063290.345556723, 1049633.272412043], [3063443.219613295, 1049633.272412044]]]]}, "properties": {"splittable": False, "x": 18888, "y": 17242, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3063748.967726434, 1044588.428545222], [3063748.967726435, 1044741.302601788], [3063748.967726434, 1044894.176658356], [3063748.967726435, 1045047.050714931], [3063901.841783005, 1045047.050714925], [3063901.841783005, 1044894.176658361], [3063901.841783005, 1044741.302601791], [3063901.841783005, 1044588.428545214], [3063748.967726434, 1044588.428545222]]]]}, "properties": {"splittable": False, "x": 18889, "y": 17238, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3064054.715839576, 1046728.6653372], [3064054.715839576, 1046575.791280635], [3063901.841783005, 1046575.791280634], [3063901.841783004, 1046728.665337203], [3064054.715839576, 1046728.6653372]]]]}, "properties": {"splittable": False, "x": 18889, "y": 17239, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3064819.0855734386, 1046881.539393774], [3064666.212065857, 1046881.539393777], [3064666.212065857, 1047034.413450341], [3064819.0855734386, 1047034.413450347], [3064819.0855734386, 1046881.539393774]]]]}, "properties": {"splittable": False, "x": 18889, "y": 17240, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3064819.086122428, 1047034.413450347], [3064819.086122428, 1046881.539393774], [3064819.0855734386, 1046881.539393774], [3064819.0855734386, 1047034.413450347], [3064819.086122428, 1047034.413450347]]]]}, "properties": {"splittable": False, "x": 18890, "y": 17240, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3065430.582348707, 1049021.776185761], [3065430.582348707, 1048868.902129187], [3065277.708292139, 1048868.902129191], [3065277.708292138, 1049021.776185757], [3065430.582348707, 1049021.776185761]]]]}, "properties": {"splittable": False, "x": 18890, "y": 17241, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3066347.826688131, 1041072.325244096], [3066194.95263156, 1041072.325244094], [3066194.952631561, 1041225.199300668], [3066347.826688131, 1041225.199300669], [3066347.826688131, 1041072.325244096]]]]}, "properties": {"splittable": False, "x": 18891, "y": 17235, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3067417.945084123, 1041989.569583517], [3067417.945084123, 1042142.443640089], [3067570.819140693, 1042142.44364009], [3067570.819140693, 1041989.56958352], [3067417.945084123, 1041989.569583517]]]]}, "properties": {"splittable": False, "x": 18892, "y": 17236, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3068640.937536685, 1035415.985150996], [3068640.937536685, 1035568.859207564], [3068793.811593256, 1035568.859207564], [3068793.811593256, 1035415.985151002], [3068640.937536685, 1035415.985150996]]]]}, "properties": {"splittable": False, "x": 18893, "y": 17230, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3068946.685649826, 1036027.481377273], [3068946.685649827, 1036180.355433851], [3068946.685649827, 1036333.229490418], [3069099.559706397, 1036333.229490413], [3069099.559706397, 1036180.355433844], [3069099.559706397, 1036027.481377279], [3068946.685649826, 1036027.481377273]]]]}, "properties": {"splittable": False, "x": 18893, "y": 17231, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3068640.937536686, 1045964.295054347], [3068640.937536686, 1046117.169110918], [3068793.811593256, 1046117.169110922], [3068793.811593256, 1045964.295054352], [3068640.937536686, 1045964.295054347]]]]}, "properties": {"splittable": False, "x": 18893, "y": 17239, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3071392.670554953, 1046881.53939377], [3071239.796498382, 1046881.539393774], [3071239.796498382, 1047034.413450347], [3071545.544611523, 1047187.287506909], [3071698.418668093, 1047187.287506909], [3071698.418668093, 1047034.413450341], [3071392.670554953, 1046881.53939377]]]]}, "properties": {"splittable": False, "x": 18895, "y": 17240, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3073074.285177226, 1046728.665337202], [3072921.411120655, 1046728.665337205], [3072921.411120655, 1046881.5392062515], [3073074.285177226, 1046881.5392062515], [3073074.285177226, 1046728.665337202]]]]}, "properties": {"splittable": False, "x": 18896, "y": 17239, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3072921.411120655, 1046881.5392062515], [3072921.411120655, 1046881.53939377], [3073074.285177226, 1046881.53939377], [3073074.285177226, 1046881.5392062515], [3072921.411120655, 1046881.5392062515]]]]}, "properties": {"splittable": False, "x": 18896, "y": 17240, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3074450.15168636, 1039237.836565251], [3074297.277629788, 1039237.836565259], [3074297.277629788, 1039390.710621827], [3074450.15168636, 1039390.710621828], [3074450.15168636, 1039237.836565251]]]]}, "properties": {"splittable": False, "x": 18897, "y": 17233, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3074755.8997995, 1041683.821470383], [3074755.8997995, 1041836.695526954], [3074755.8997995, 1041989.5693968758], [3075061.647912642, 1041989.5693968758], [3075061.647912642, 1041836.695526945], [3075061.64791264, 1041683.821470377], [3074908.77385607, 1041683.821470385], [3074755.8997995, 1041683.821470383]]]]}, "properties": {"splittable": False, "x": 18898, "y": 17235, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3074755.8997995, 1041989.5693968758], [3074755.8997995, 1041989.569583527], [3074908.77385607, 1041989.569583519], [3075061.647912642, 1041989.569583527], [3075061.647912642, 1041989.5693968758], [3074755.8997995, 1041989.5693968758]]]]}, "properties": {"splittable": False, "x": 18898, "y": 17236, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3075061.647912642, 1043671.184205799], [3074908.77385607, 1043671.184205798], [3074908.77385607, 1043824.058262367], [3075061.647912642, 1043824.058262361], [3075214.52196921, 1043824.058262367], [3075367.396025781, 1043824.058262367], [3075367.396025781, 1043671.184205796], [3075214.52196921, 1043671.184205794], [3075061.647912642, 1043671.184205799]]]]}, "properties": {"splittable": False, "x": 18898, "y": 17237, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3075978.892252062, 1036944.7257167], [3075826.018195493, 1036944.725716705], [3075826.018195493, 1037097.5995875001], [3075978.892252063, 1037097.5995875001], [3075978.892252062, 1036944.7257167]]]]}, "properties": {"splittable": False, "x": 18899, "y": 17231, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3075826.018195493, 1037097.5995875001], [3075826.018195493, 1037097.599773272], [3075978.892252063, 1037097.599773273], [3075978.892252063, 1037097.5995875001], [3075826.018195493, 1037097.5995875001]]]]}, "properties": {"splittable": False, "x": 18899, "y": 17232, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3077049.010096874, 1042601.065809801], [3076896.136591486, 1042601.065809804], [3076896.136591486, 1042753.939866378], [3077049.010096874, 1042753.939866376], [3077049.010096874, 1042601.065809801]]]]}, "properties": {"splittable": False, "x": 18899, "y": 17236, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3077049.010096874, 1047951.657789766], [3076896.136591486, 1047951.657789766], [3076896.136591486, 1048104.5316585936], [3077049.010096874, 1048104.5316585936], [3077049.010096874, 1047951.657789766]]]]}, "properties": {"splittable": False, "x": 18899, "y": 17240, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3076896.136591486, 1048104.5316585936], [3076896.136591486, 1048104.531846338], [3077049.010096874, 1048104.531846333], [3077049.010096874, 1048104.5316585936], [3076896.136591486, 1048104.5316585936]]]]}, "properties": {"splittable": False, "x": 18899, "y": 17241, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3078119.129044048, 1040307.954961242], [3077966.254987478, 1040307.954961248], [3077966.254987478, 1040460.829017824], [3078119.129044048, 1040460.829017822], [3078119.129044048, 1040307.954961242]]]]}, "properties": {"splittable": False, "x": 18900, "y": 17234, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3077049.010648055, 1042601.065809801], [3077049.010096874, 1042601.065809801], [3077049.010096874, 1042753.939866376], [3077049.010648055, 1042753.939866376], [3077201.884704626, 1042753.939866369], [3077201.884704625, 1042601.065809806], [3077049.010648055, 1042601.065809801]]]]}, "properties": {"splittable": False, "x": 18900, "y": 17236, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3077049.010648055, 1047951.657789766], [3077049.010096874, 1047951.657789766], [3077049.010096874, 1048104.5316585936], [3077049.010648055, 1048104.5316585936], [3077049.010648055, 1047951.657789766]]]]}, "properties": {"splittable": False, "x": 18900, "y": 17240, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3077049.010096874, 1048104.531846333], [3077049.010648055, 1048104.531846333], [3077049.010648055, 1048104.5316585936], [3077049.010096874, 1048104.5316585936], [3077049.010096874, 1048104.531846333]]]]}, "properties": {"splittable": False, "x": 18900, "y": 17241, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3079189.247440042, 1036027.481377278], [3079189.24744004, 1035874.607320712], [3079036.37338347, 1035874.607320709], [3079036.37338347, 1036027.481377278], [3079189.247440042, 1036027.481377278]]]]}, "properties": {"splittable": False, "x": 18901, "y": 17231, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3079189.24744004, 1041989.569583523], [3079189.24744004, 1042142.443640094], [3079342.12149661, 1042142.443640095], [3079342.12149661, 1041989.56958352], [3079189.24744004, 1041989.569583523]]]]}, "properties": {"splittable": False, "x": 18901, "y": 17236, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3081788.106401737, 1041836.695526954], [3081635.232345166, 1041836.695526956], [3081635.232345166, 1041989.5693968758], [3081940.97990625, 1041989.5693968758], [3081940.97990625, 1041836.695526956], [3081788.106401737, 1041836.695526954]]]]}, "properties": {"splittable": False, "x": 18903, "y": 17235, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3081635.232345166, 1041989.5693968758], [3081635.232345166, 1041989.56958352], [3081788.106401735, 1041989.56958352], [3081940.97990625, 1041989.569583517], [3081940.97990625, 1041989.5693968758], [3081635.232345166, 1041989.5693968758]]]]}, "properties": {"splittable": False, "x": 18903, "y": 17236, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3082093.854514876, 1038320.5920398422], [3082093.854514877, 1038167.718169259], [3081940.980458307, 1038167.718169259], [3081940.980458307, 1038320.5920398422], [3082093.854514876, 1038320.5920398422]]]]}, "properties": {"splittable": False, "x": 18904, "y": 17232, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3082093.854514876, 1038320.592225835], [3082093.854514876, 1038320.5920398422], [3081940.980458307, 1038320.5920398422], [3081940.980458307, 1038320.592225829], [3082093.854514876, 1038320.592225835]]]]}, "properties": {"splittable": False, "x": 18904, "y": 17233, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3082093.854514876, 1041989.5693968758], [3082093.854514876, 1041836.695526945], [3081940.980458307, 1041836.695526956], [3081940.97990625, 1041836.695526956], [3081940.97990625, 1041989.5693968758], [3082093.854514876, 1041989.5693968758]]]]}, "properties": {"splittable": False, "x": 18904, "y": 17235, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3082552.476684588, 1042295.317696662], [3082399.602628018, 1042295.317696666], [3082399.602628017, 1042448.191753237], [3082552.476684588, 1042601.0658098], [3082705.350741159, 1042601.065809808], [3082705.350741159, 1042448.19175323], [3082552.476684588, 1042295.317696662]]], [[[3081940.97990625, 1041989.569583517], [3081940.980458305, 1041989.569583517], [3082093.854514876, 1041989.569583525], [3082093.854514876, 1041989.5693968758], [3081940.97990625, 1041989.5693968758], [3081940.97990625, 1041989.569583517]]]]}, "properties": {"splittable": False, "x": 18904, "y": 17236, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3082552.476684588, 1044894.176658363], [3082399.602628018, 1044894.176658356], [3082399.602628017, 1045047.050714931], [3082552.476684588, 1045047.050714934], [3082552.476684588, 1044894.176658363]]]]}, "properties": {"splittable": False, "x": 18904, "y": 17238, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3084081.21725029, 1036180.355433844], [3084081.217250292, 1036027.481377278], [3083928.343193721, 1036027.481377278], [3083775.469137151, 1036027.481377278], [3083775.469137151, 1036180.355433854], [3083928.343193721, 1036180.355433849], [3084081.21725029, 1036180.355433844]]], [[[3084081.217250292, 1036791.851660128], [3084081.217250292, 1036944.725716695], [3084234.091306862, 1036944.725716702], [3084234.091306861, 1036791.851660126], [3084081.217250292, 1036791.851660128]]]]}, "properties": {"splittable": False, "x": 18905, "y": 17231, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3084234.09130198, 1043772.519695203], [3084234.091306861, 1043671.184205799], [3084081.217250292, 1043671.184205798], [3084081.217245433, 1043772.827025576], [3084081.217250292, 1043824.058262366], [3084081.217250292, 1044129.806375503], [3084081.217250292, 1044282.680432072], [3084234.091306862, 1044282.680432079], [3084234.091306862, 1044129.806375503], [3084234.091306862, 1043824.058262361], [3084234.09130198, 1043772.519695203]]]]}, "properties": {"splittable": False, "x": 18905, "y": 17237, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3085457.083759424, 1035263.111094425], [3085457.083759424, 1035415.985150996], [3085609.9572632797, 1035415.985150996], [3085609.9572632797, 1035263.111094428], [3085457.083759424, 1035263.111094425]]]]}, "properties": {"splittable": False, "x": 18906, "y": 17230, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3085609.9572632797, 1035415.985150996], [3085609.957815995, 1035415.985150996], [3085609.957815994, 1035263.111094428], [3085609.9572632797, 1035263.111094428], [3085609.9572632797, 1035415.985150996]]]]}, "properties": {"splittable": False, "x": 18907, "y": 17230, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3087138.698381699, 1043976.932318933], [3086985.824325128, 1043976.932318939], [3086985.824325128, 1044129.806375507], [3086985.824325128, 1044282.680432072], [3087138.698381697, 1044282.680432071], [3087291.572438268, 1044282.680432079], [3087291.572438269, 1044129.806375503], [3087291.572438268, 1043976.93231894], [3087138.698381699, 1043976.932318933]]]]}, "properties": {"splittable": False, "x": 18908, "y": 17237, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3091113.423852528, 1035263.111094428], [3091113.423852528, 1035415.985150992], [3091266.297909098, 1035568.859207569], [3091419.171965668, 1035568.859207567], [3091419.171965668, 1035415.985150996], [3091266.297909098, 1035263.11109442], [3091113.423852528, 1035263.111094428]]]]}, "properties": {"splittable": False, "x": 18911, "y": 17230, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3090960.549795958, 1042601.065809806], [3090807.675739387, 1042601.065809804], [3090807.675739386, 1042753.939866378], [3090807.675739387, 1042906.813922941], [3090960.549795958, 1042906.813922946], [3090960.549795957, 1042753.939866376], [3090960.549795958, 1042601.065809806]]]]}, "properties": {"splittable": False, "x": 18911, "y": 17236, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3092489.290361661, 1041989.56958352], [3092336.41630509, 1041989.56958352], [3092336.41630509, 1042142.443640088], [3092489.290361661, 1042142.443640088], [3092642.164418231, 1042142.443640094], [3092795.0384748, 1042142.443640094], [3092795.038474801, 1041989.56958352], [3092642.164418231, 1041989.569583517], [3092489.290361661, 1041989.56958352]]]]}, "properties": {"splittable": False, "x": 18912, "y": 17236, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3093406.534701082, 1040002.206848104], [3093406.534701082, 1039849.332791534], [3093253.660644513, 1039849.332791533], [3093253.660644513, 1040002.206848105], [3093406.534701082, 1040002.206848104]]]]}, "properties": {"splittable": False, "x": 18913, "y": 17234, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3095088.149323357, 1039849.332791539], [3095088.149323357, 1040002.206848104], [3095241.023379927, 1040002.20684811], [3095393.896882031, 1040002.206848106], [3095393.896882031, 1039849.332791538], [3095241.023379928, 1039849.332791538], [3095088.149323357, 1039849.332791539]]], [[[3094629.527153646, 1040002.206848114], [3094476.653097075, 1040002.206848109], [3094476.653097075, 1040155.080904674], [3094629.527153646, 1040155.080904678], [3094629.527153646, 1040002.206848114]]]]}, "properties": {"splittable": False, "x": 18914, "y": 17234, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3094782.401210216, 1041378.073357238], [3094782.401210216, 1041225.199300665], [3094629.527153646, 1041225.199300665], [3094629.527153646, 1041378.073357246], [3094782.401210216, 1041378.073357238]]]]}, "properties": {"splittable": False, "x": 18914, "y": 17235, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3095393.896882031, 1040002.206848106], [3095393.897436496, 1040002.206848106], [3095393.897436496, 1039849.332791538], [3095393.896882031, 1039849.332791538], [3095393.896882031, 1040002.206848106]]]]}, "properties": {"splittable": False, "x": 18915, "y": 17234, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3097687.008285054, 1033734.370528723], [3097687.008285054, 1033581.496472148], [3097534.134228482, 1033581.496472153], [3097534.134228481, 1033734.370528723], [3097687.008285054, 1033734.370528723]]]]}, "properties": {"splittable": False, "x": 18916, "y": 17229, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3097992.756398193, 1033122.874302443], [3097992.756398193, 1032970.000245875], [3097839.882341623, 1032970.000245868], [3097839.882341623, 1033122.874302443], [3097992.756398193, 1033122.874302443]]]]}, "properties": {"splittable": False, "x": 18917, "y": 17228, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3100132.993190178, 1034192.992698434], [3100132.993190178, 1034040.118641863], [3099980.119133608, 1034040.118641869], [3099980.119133608, 1034192.992698431], [3100132.993190178, 1034192.992698434]]]]}, "properties": {"splittable": False, "x": 18918, "y": 17229, "zoom": 15}}, {"type": "Feature", "geometry": {"type": "MultiPolygon", "coordinates": [[[[3105177.837057, 1033581.496472157], [3105177.837057, 1033734.370528728], [3105330.71111357, 1033887.24458529], [3105483.58517014, 1033887.244585291], [3105483.58517014, 1033734.370528729], [3105483.58517014, 1033581.496472154], [3105330.71111357, 1033581.496472153], [3105177.837057, 1033581.496472157]]]]}, "properties": {"splittable": False, "x": 18923, "y": 17229, "zoom": 15}}])

        # act
        result = GridService.trim_grid_to_aoi(grid_dto)

        # assert
        self.assertEquals(json.dumps(expected), json.dumps(result))

    def test_trim_grid_to_aoi_noclip(self):
        # arrange

        grid_json = get_canned_grid_request()
        grid_dto = GridDTO(grid_json)
        grid_dto.clip_to_aoi = False

        expected = {"features": [{"geometry": {"coordinates": [[[[3047697.1912406236, 1046881.5392062515], [3047697.1912406236, 1048104.5316585936], [3048920.1836929694, 1048104.5316585936], [3048920.1836929694, 1046881.5392062515], [3047697.1912406236, 1046881.5392062515]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18876, "y": 17240, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3048920.1836929694, 1041989.5693968758], [3048920.1836929694, 1043212.5618492179], [3050143.1761453114, 1043212.5618492179], [3050143.1761453114, 1041989.5693968758], [3048920.1836929694, 1041989.5693968758]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18877, "y": 17236, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3051366.1685976572, 1043212.5618492179], [3051366.1685976572, 1044435.5543015637], [3052589.1610499993, 1044435.5543015637], [3052589.1610499993, 1043212.5618492179], [3051366.1685976572, 1043212.5618492179]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18879, "y": 17237, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3056258.138407033, 1035874.607135158], [3056258.138407033, 1037097.5995875001], [3057481.130859375, 1037097.5995875001], [3057481.130859375, 1035874.607135158], [3056258.138407033, 1035874.607135158]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18883, "y": 17231, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3056258.138407033, 1038320.5920398422], [3056258.138407033, 1039543.584492188], [3057481.130859375, 1039543.584492188], [3057481.130859375, 1038320.5920398422], [3056258.138407033, 1038320.5920398422]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18883, "y": 17233, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3057481.130859375, 1035874.607135158], [3057481.130859375, 1037097.5995875001], [3058704.123311721, 1037097.5995875001], [3058704.123311721, 1035874.607135158], [3057481.130859375, 1035874.607135158]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18884, "y": 17231, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3057481.130859375, 1041989.5693968758], [3057481.130859375, 1043212.5618492179], [3058704.123311721, 1043212.5618492179], [3058704.123311721, 1041989.5693968758], [3057481.130859375, 1041989.5693968758]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18884, "y": 17236, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3057481.130859375, 1046881.5392062515], [3057481.130859375, 1048104.5316585936], [3058704.123311721, 1048104.5316585936], [3058704.123311721, 1046881.5392062515], [3057481.130859375, 1046881.5392062515]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18884, "y": 17240, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3057481.130859375, 1048104.5316585936], [3057481.130859375, 1049327.5241109394], [3058704.123311721, 1049327.5241109394], [3058704.123311721, 1048104.5316585936], [3057481.130859375, 1048104.5316585936]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18884, "y": 17241, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3058704.123311721, 1041989.5693968758], [3058704.123311721, 1043212.5618492179], [3059927.115764063, 1043212.5618492179], [3059927.115764063, 1041989.5693968758], [3058704.123311721, 1041989.5693968758]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18885, "y": 17236, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3058704.123311721, 1048104.5316585936], [3058704.123311721, 1049327.5241109394], [3059927.115764063, 1049327.5241109394], [3059927.115764063, 1048104.5316585936], [3058704.123311721, 1048104.5316585936]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18885, "y": 17241, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3062373.1006687507, 1049327.5241109394], [3062373.1006687507, 1050550.5165632814], [3063596.0931210928, 1050550.5165632814], [3063596.0931210928, 1049327.5241109394], [3062373.1006687507, 1049327.5241109394]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18888, "y": 17242, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3063596.0931210928, 1044435.5543015637], [3063596.0931210928, 1045658.5467539057], [3064819.0855734386, 1045658.5467539057], [3064819.0855734386, 1044435.5543015637], [3063596.0931210928, 1044435.5543015637]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18889, "y": 17238, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3063596.0931210928, 1045658.5467539057], [3063596.0931210928, 1046881.5392062515], [3064819.0855734386, 1046881.5392062515], [3064819.0855734386, 1045658.5467539057], [3063596.0931210928, 1045658.5467539057]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18889, "y": 17239, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3063596.0931210928, 1046881.5392062515], [3063596.0931210928, 1048104.5316585936], [3064819.0855734386, 1048104.5316585936], [3064819.0855734386, 1046881.5392062515], [3063596.0931210928, 1046881.5392062515]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18889, "y": 17240, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3064819.0855734386, 1046881.5392062515], [3064819.0855734386, 1048104.5316585936], [3066042.0780257806, 1048104.5316585936], [3066042.0780257806, 1046881.5392062515], [3064819.0855734386, 1046881.5392062515]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18890, "y": 17240, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3064819.0855734386, 1048104.5316585936], [3064819.0855734386, 1049327.5241109394], [3066042.0780257806, 1049327.5241109394], [3066042.0780257806, 1048104.5316585936], [3064819.0855734386, 1048104.5316585936]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18890, "y": 17241, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3066042.0780257806, 1040766.57694453], [3066042.0780257806, 1041989.5693968758], [3067265.0704781264, 1041989.5693968758], [3067265.0704781264, 1040766.57694453], [3066042.0780257806, 1040766.57694453]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18891, "y": 17235, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3067265.0704781264, 1041989.5693968758], [3067265.0704781264, 1043212.5618492179], [3068488.0629304685, 1043212.5618492179], [3068488.0629304685, 1041989.5693968758], [3067265.0704781264, 1041989.5693968758]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18892, "y": 17236, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3068488.0629304685, 1034651.6146828122], [3068488.0629304685, 1035874.607135158], [3069711.0553828143, 1035874.607135158], [3069711.0553828143, 1034651.6146828122], [3068488.0629304685, 1034651.6146828122]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18893, "y": 17230, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3068488.0629304685, 1035874.607135158], [3068488.0629304685, 1037097.5995875001], [3069711.0553828143, 1037097.5995875001], [3069711.0553828143, 1035874.607135158], [3068488.0629304685, 1035874.607135158]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18893, "y": 17231, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3068488.0629304685, 1045658.5467539057], [3068488.0629304685, 1046881.5392062515], [3069711.0553828143, 1046881.5392062515], [3069711.0553828143, 1045658.5467539057], [3068488.0629304685, 1045658.5467539057]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18893, "y": 17239, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3070934.0478351563, 1046881.5392062515], [3070934.0478351563, 1048104.5316585936], [3072157.0402874984, 1048104.5316585936], [3072157.0402874984, 1046881.5392062515], [3070934.0478351563, 1046881.5392062515]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18895, "y": 17240, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3072157.0402874984, 1045658.5467539057], [3072157.0402874984, 1046881.5392062515], [3073380.032739844, 1046881.5392062515], [3073380.032739844, 1045658.5467539057], [3072157.0402874984, 1045658.5467539057]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18896, "y": 17239, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3072157.0402874984, 1046881.5392062515], [3072157.0402874984, 1048104.5316585936], [3073380.032739844, 1048104.5316585936], [3073380.032739844, 1046881.5392062515], [3072157.0402874984, 1046881.5392062515]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18896, "y": 17240, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3073380.032739844, 1038320.5920398422], [3073380.032739844, 1039543.584492188], [3074603.0251921862, 1039543.584492188], [3074603.0251921862, 1038320.5920398422], [3073380.032739844, 1038320.5920398422]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18897, "y": 17233, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3074603.0251921862, 1040766.57694453], [3074603.0251921862, 1041989.5693968758], [3075826.017644532, 1041989.5693968758], [3075826.017644532, 1040766.57694453], [3074603.0251921862, 1040766.57694453]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18898, "y": 17235, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3074603.0251921862, 1041989.5693968758], [3074603.0251921862, 1043212.5618492179], [3075826.017644532, 1043212.5618492179], [3075826.017644532, 1041989.5693968758], [3074603.0251921862, 1041989.5693968758]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18898, "y": 17236, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3074603.0251921862, 1043212.5618492179], [3074603.0251921862, 1044435.5543015637], [3075826.017644532, 1044435.5543015637], [3075826.017644532, 1043212.5618492179], [3074603.0251921862, 1043212.5618492179]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18898, "y": 17237, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3075826.017644532, 1035874.607135158], [3075826.017644532, 1037097.5995875001], [3077049.010096874, 1037097.5995875001], [3077049.010096874, 1035874.607135158], [3075826.017644532, 1035874.607135158]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18899, "y": 17231, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3075826.017644532, 1037097.5995875001], [3075826.017644532, 1038320.5920398422], [3077049.010096874, 1038320.5920398422], [3077049.010096874, 1037097.5995875001], [3075826.017644532, 1037097.5995875001]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18899, "y": 17232, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3075826.017644532, 1041989.5693968758], [3075826.017644532, 1043212.5618492179], [3077049.010096874, 1043212.5618492179], [3077049.010096874, 1041989.5693968758], [3075826.017644532, 1041989.5693968758]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18899, "y": 17236, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3075826.017644532, 1046881.5392062515], [3075826.017644532, 1048104.5316585936], [3077049.010096874, 1048104.5316585936], [3077049.010096874, 1046881.5392062515], [3075826.017644532, 1046881.5392062515]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18899, "y": 17240, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3075826.017644532, 1048104.5316585936], [3075826.017644532, 1049327.5241109394], [3077049.010096874, 1049327.5241109394], [3077049.010096874, 1048104.5316585936], [3075826.017644532, 1048104.5316585936]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18899, "y": 17241, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3077049.010096874, 1039543.584492188], [3077049.010096874, 1040766.57694453], [3078272.00254922, 1040766.57694453], [3078272.00254922, 1039543.584492188], [3077049.010096874, 1039543.584492188]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18900, "y": 17234, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3077049.010096874, 1041989.5693968758], [3077049.010096874, 1043212.5618492179], [3078272.00254922, 1043212.5618492179], [3078272.00254922, 1041989.5693968758], [3077049.010096874, 1041989.5693968758]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18900, "y": 17236, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3077049.010096874, 1046881.5392062515], [3077049.010096874, 1048104.5316585936], [3078272.00254922, 1048104.5316585936], [3078272.00254922, 1046881.5392062515], [3077049.010096874, 1046881.5392062515]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18900, "y": 17240, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3077049.010096874, 1048104.5316585936], [3077049.010096874, 1049327.5241109394], [3078272.00254922, 1049327.5241109394], [3078272.00254922, 1048104.5316585936], [3077049.010096874, 1048104.5316585936]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18900, "y": 17241, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3078272.00254922, 1035874.607135158], [3078272.00254922, 1037097.5995875001], [3079494.995001562, 1037097.5995875001], [3079494.995001562, 1035874.607135158], [3078272.00254922, 1035874.607135158]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18901, "y": 17231, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3078272.00254922, 1041989.5693968758], [3078272.00254922, 1043212.5618492179], [3079494.995001562, 1043212.5618492179], [3079494.995001562, 1041989.5693968758], [3078272.00254922, 1041989.5693968758]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18901, "y": 17236, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3080717.9874539077, 1040766.57694453], [3080717.9874539077, 1041989.5693968758], [3081940.97990625, 1041989.5693968758], [3081940.97990625, 1040766.57694453], [3080717.9874539077, 1040766.57694453]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18903, "y": 17235, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3080717.9874539077, 1041989.5693968758], [3080717.9874539077, 1043212.5618492179], [3081940.97990625, 1043212.5618492179], [3081940.97990625, 1041989.5693968758], [3080717.9874539077, 1041989.5693968758]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18903, "y": 17236, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3081940.97990625, 1037097.5995875001], [3081940.97990625, 1038320.5920398422], [3083163.9723585956, 1038320.5920398422], [3083163.9723585956, 1037097.5995875001], [3081940.97990625, 1037097.5995875001]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18904, "y": 17232, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3081940.97990625, 1038320.5920398422], [3081940.97990625, 1039543.584492188], [3083163.9723585956, 1039543.584492188], [3083163.9723585956, 1038320.5920398422], [3081940.97990625, 1038320.5920398422]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18904, "y": 17233, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3081940.97990625, 1040766.57694453], [3081940.97990625, 1041989.5693968758], [3083163.9723585956, 1041989.5693968758], [3083163.9723585956, 1040766.57694453], [3081940.97990625, 1040766.57694453]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18904, "y": 17235, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3081940.97990625, 1041989.5693968758], [3081940.97990625, 1043212.5618492179], [3083163.9723585956, 1043212.5618492179], [3083163.9723585956, 1041989.5693968758], [3081940.97990625, 1041989.5693968758]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18904, "y": 17236, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3081940.97990625, 1044435.5543015637], [3081940.97990625, 1045658.5467539057], [3083163.9723585956, 1045658.5467539057], [3083163.9723585956, 1044435.5543015637], [3081940.97990625, 1044435.5543015637]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18904, "y": 17238, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3083163.9723585956, 1035874.607135158], [3083163.9723585956, 1037097.5995875001], [3084386.9648109376, 1037097.5995875001], [3084386.9648109376, 1035874.607135158], [3083163.9723585956, 1035874.607135158]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18905, "y": 17231, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3083163.9723585956, 1043212.5618492179], [3083163.9723585956, 1044435.5543015637], [3084386.9648109376, 1044435.5543015637], [3084386.9648109376, 1043212.5618492179], [3083163.9723585956, 1043212.5618492179]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18905, "y": 17237, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3084386.9648109376, 1034651.6146828122], [3084386.9648109376, 1035874.607135158], [3085609.9572632797, 1035874.607135158], [3085609.9572632797, 1034651.6146828122], [3084386.9648109376, 1034651.6146828122]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18906, "y": 17230, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3085609.9572632797, 1034651.6146828122], [3085609.9572632797, 1035874.607135158], [3086832.9497156255, 1035874.607135158], [3086832.9497156255, 1034651.6146828122], [3085609.9572632797, 1034651.6146828122]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18907, "y": 17230, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3086832.9497156255, 1043212.5618492179], [3086832.9497156255, 1044435.5543015637], [3088055.9421679676, 1044435.5543015637], [3088055.9421679676, 1043212.5618492179], [3086832.9497156255, 1043212.5618492179]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18908, "y": 17237, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3090501.9270726554, 1034651.6146828122], [3090501.9270726554, 1035874.607135158], [3091724.919525001, 1035874.607135158], [3091724.919525001, 1034651.6146828122], [3090501.9270726554, 1034651.6146828122]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18911, "y": 17230, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3090501.9270726554, 1041989.5693968758], [3090501.9270726554, 1043212.5618492179], [3091724.919525001, 1043212.5618492179], [3091724.919525001, 1041989.5693968758], [3090501.9270726554, 1041989.5693968758]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18911, "y": 17236, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3091724.919525001, 1041989.5693968758], [3091724.919525001, 1043212.5618492179], [3092947.9119773433, 1043212.5618492179], [3092947.9119773433, 1041989.5693968758], [3091724.919525001, 1041989.5693968758]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18912, "y": 17236, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3092947.9119773433, 1039543.584492188], [3092947.9119773433, 1040766.57694453], [3094170.904429689, 1040766.57694453], [3094170.904429689, 1039543.584492188], [3092947.9119773433, 1039543.584492188]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18913, "y": 17234, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3094170.904429689, 1039543.584492188], [3094170.904429689, 1040766.57694453], [3095393.896882031, 1040766.57694453], [3095393.896882031, 1039543.584492188], [3094170.904429689, 1039543.584492188]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18914, "y": 17234, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3094170.904429689, 1040766.57694453], [3094170.904429689, 1041989.5693968758], [3095393.896882031, 1041989.5693968758], [3095393.896882031, 1040766.57694453], [3094170.904429689, 1040766.57694453]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18914, "y": 17235, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3095393.896882031, 1039543.584492188], [3095393.896882031, 1040766.57694453], [3096616.889334377, 1040766.57694453], [3096616.889334377, 1039543.584492188], [3095393.896882031, 1039543.584492188]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18915, "y": 17234, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3096616.889334377, 1033428.6222304702], [3096616.889334377, 1034651.6146828122], [3097839.881786719, 1034651.6146828122], [3097839.881786719, 1033428.6222304702], [3096616.889334377, 1033428.6222304702]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18916, "y": 17229, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3097839.881786719, 1032205.6297781244], [3097839.881786719, 1033428.6222304702], [3099062.874239061, 1033428.6222304702], [3099062.874239061, 1032205.6297781244], [3097839.881786719, 1032205.6297781244]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18917, "y": 17228, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3099062.874239061, 1033428.6222304702], [3099062.874239061, 1034651.6146828122], [3100285.866691407, 1034651.6146828122], [3100285.866691407, 1033428.6222304702], [3099062.874239061, 1033428.6222304702]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18918, "y": 17229, "zoom": 15}, "type": "Feature"}, {"geometry": {"coordinates": [[[[3105177.8365007825, 1033428.6222304702], [3105177.8365007825, 1034651.6146828122], [3106400.8289531246, 1034651.6146828122], [3106400.8289531246, 1033428.6222304702], [3105177.8365007825, 1033428.6222304702]]]], "type": "MultiPolygon"}, "properties": {"splittable": True, "x": 18923, "y": 17229, "zoom": 15}, "type": "Feature"}], "type": "FeatureCollection"}

        # act
        result = GridService.trim_grid_to_aoi(grid_dto)

        # assert
        self.assertEquals(expected, result)
